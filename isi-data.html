<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pertanyaan — Survey Driver</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    body {
      background: #ffffff;
      font-family: sans-serif;
    }
    .header {
      padding: 1rem;
      background: white;
      border-bottom: 1px solid #e2e8f0;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .header-top {
      display: flex;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    .progress-segments {
      display: flex;
      gap: 0.5rem;
    }
    .progress-segments > div {
      flex: 1;
      height: 8px;
      border-radius: 999px;
      background: #e2e8f0;
      transition: background 0.5s ease;
    }
    .progress-segments > div.active {
      background: #0ea75a;
    }
    .radio-circle {
      width: 34px; height: 34px; border-radius: 999px;
      border: 2px solid #cfcfcf; display:flex; align-items:center; justify-content:center;
      background: white;
      transition: all .2s;
    }
    .radio-circle.selected {
      border-color: #0ea75a;
      background: radial-gradient(circle at center, #0ea75a 0%, #0b8f49 100%);
    }
    .radio-circle.selected::after {
      content: "";
      width: 14px; height: 14px; border-radius: 50%; background: white;
    }
    .popup {
      position: fixed;
      inset:0;
      background: rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 50;
      display: none;
    }
    .popup-content {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      text-align: center;
      max-width: 320px;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <div class="header">
    <div class="header-top">
      <button onclick="history.back()" class="text-gray-700 text-xl mr-4">
        <i class="fa-solid fa-arrow-left"></i>
      </button>
      <div class="text-gray-800 text-lg font-semibold flex items-center">
        <span class="mr-2">&lt;----</span> Pertanyaan <span id="currentIndexText">1</span> dari 4
      </div>
    </div>
    <!-- Progress bar -->
    <div class="progress-segments">
      <div id="seg0" class="active"></div>
      <div id="seg1"></div>
      <div id="seg2"></div>
      <div id="seg3"></div>
    </div>
  </div>

  <!-- Konten -->
  <main class="max-w-2xl mx-auto w-full mt-6 px-4 transition-all duration-500">
    <section class="bg-white rounded-2xl p-6 shadow">
      <h2 id="questionText" class="text-2xl font-bold text-gray-800 mb-4"></h2>
      <div id="optionsContainer" class="space-y-4"></div>
    </section>
  </main>

  <!-- Popup Gagal -->
  <div id="popupFail" class="popup">
    <div class="popup-content">
      <h3 class="text-xl font-bold mb-2">Maaf</h3>
      <p class="text-gray-700 mb-4">Pendaftaranmu tidak bisa dilanjutkan. Silahkan ulangi!</p>
      <button id="btnRestartPopup" class="bg-green-500 text-white px-4 py-2 rounded-full">Kembali</button>
    </div>
  </div>

  <script>
    const questions = [
      { id: 'q1', text: 'Apakah Anda berusia 18–60 tahun?', options: ['Ya','Tidak'] },
      { id: 'q2', text: 'Apakah Anda memiliki E-KTP dan SIM A yang masih berlaku?', options: ['Ya','Tidak'] },
      { id: 'q3', text: 'Apakah usia kendaraan yang Anda gunakan 12 tahun?', options: ['Ya','Tidak'] },
      { id: 'q4', text: 'Apakah Anda memiliki rekening bank?', options: ['Ya','Tidak'] }
    ];

    let currentIndex = 0;
    let answers = {};

    const questionTextEl = document.getElementById('questionText');
    const optionsContainer = document.getElementById('optionsContainer');
    const currentIndexText = document.getElementById('currentIndexText');
    const popupFail = document.getElementById('popupFail');
    const segEls = [document.getElementById('seg0'), document.getElementById('seg1'), document.getElementById('seg2'), document.getElementById('seg3')];

    function renderQuestion() {
      const q = questions[currentIndex];
      questionTextEl.textContent = q.text;
      currentIndexText.textContent = currentIndex + 1;

      segEls.forEach((el, i) => el.classList.toggle('active', i <= currentIndex && answers[questions[i].id]));

      optionsContainer.innerHTML = '';
      q.options.forEach(opt => {
        const btn = document.createElement('div');
        btn.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-xl cursor-pointer border transition';
        btn.innerHTML = `
          <div class="flex items-center space-x-4">
            <div class="radio-circle" data-opt="${opt}"></div>
            <div class="text-gray-800 font-medium">${opt}</div>
          </div>
          <i class="fa-solid fa-chevron-right text-gray-400"></i>
        `;
        btn.addEventListener('click', () => onSelectOption(opt, btn));
        optionsContainer.appendChild(btn);
      });
    }

    function onSelectOption(opt, cardEl) {
      optionsContainer.querySelectorAll('.radio-circle').forEach(rc => rc.classList.remove('selected'));
      const circle = cardEl.querySelector('.radio-circle');
      circle.classList.add('selected');

      const qid = questions[currentIndex].id;
      answers[qid] = opt;

      setTimeout(() => {
        if (currentIndex < questions.length - 1) {
          currentIndex++;
          renderQuestion();
        } else {
          finishSurvey();
        }
      }, 300);
    }

    document.getElementById('btnRestartPopup').onclick = () => {
      answers = {};
      currentIndex = 0;
      popupFail.style.display = 'none';
      renderQuestion();
    };

    function finishSurvey() {
      const hasNo = Object.values(answers).some(v => v === 'Tidak');
      if(hasNo){
        popupFail.style.display = 'flex';
      } else {
        // Semua jawaban Ya → langsung ke halaman baru
        window.location.href = 'databaru.html';
      }
    }

    renderQuestion();
  </script>
</body>
</html>
